<link rel="stylesheet" href="css/arch-styles.css">
<div class="panel panel-default">
    <div class="panel-heading">Logged in as: {{contact.first_name}} {{contact.last_name}}
        <div class="options">
            <a href="/logout">Logout</a>
        </div>
    </div>
    <div class="panel-body main-body">
        <div class="col-lg-2">
            <div class="panel panel-info">
                <div class="panel-heading">Client List:</div>
                <div class="panel-body fillable">
                    <ul>
                        {{#each arch}}
                        <li>
                            <button class="btn btn-link" onClick="getClient({{this.id}});">
                        {{this.Contact.first_name}} {{this.Contact.last_name}}
                      </button>
                        </li>
                        {{/each}}
                    </ul>
                    <div class="bot-tag">
                        <hr>
                        <h4>Add a new Client</h4>
                        <a href="/addClientPage">ADD CLIENT</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-9">
            <div class="panel panel-info col-lg-5">
                <div class="panel-heading">
                    Client Information:
                </div>
                <div class="panel-body fillable left-side">
                    <ul>
                        <li><strong>Address:</strong> <br><span id="clientAddr">Client Address</span></li>
                        <li><strong>Email:</strong> <span id="clientEmail">Client Email</span></li>
                        <li><strong>Phone:</strong> <span id="clientPhone">Client Phone</span></li>
                    </ul>
                </div>
            </div>
            <div class="panel panel-info files col-lg-6">
                <div class="panel-heading">Files:</div>
                <div class="panel-body fillable left-side">
                    <ul id="clientFiles">

                    </ul>
                    <div class="bot-tag" id="uploadFiles">

                    </div>
                </div>

            </div>
            <div class="panel panel-info col-lg-11 comment-section">
                <div class="panel-heading">
                    Comments
                </div>
                <div class="panel-body fillable comments">

                </div>
            </div>
        </div>
    </div>
</div>
<div><a href="/archSettings">Settings</a></div>
<script type="text/javascript">
    function getClient(x) { //show client contact info d
      $('#uploadFiles').html();
        $.ajax({
            url: '/getClientData/' + x,
            method: 'GET'
        }).then(function (response) {
            console.log(response);
            $('#clientAddr').html(response.addr_number + ' ' +
                response.addr_street + ' Apt. ' + response.apt_number + ' <br>' +
                response.city + ', ' + response.state + ' ' + response.zip_code);
            $('#clientEmail').html(response.User.email);
            $('#clientPhone').html(response.phone_number);
            $('#uploadFiles').append('<button class="btn btn-lg upload-btn" type="button">Upload File</button><input id="upload-input" type="file" name="uploads[]" value="'+ response.id+'" multiple="multiple">');
            let a = response.ArchFiles;
            for(var i=0; i < a.length; i++){
              $('#clientFiles').append('<button class="btn btn-default" onClick="getFile('+ response.ArchFiles[i].id +')">' + response.ArchFiles[i].name +'</button>');
            };
        }).catch(function (err) {
            console.error(err);
        });
    }

    function getFile(x){
      $.ajax({
        url: '/download/' + x,
        method: 'GET'
      }).then(function(response){
        console.log(response);
      });
    }

</script>
